import { DataSource } from 'typeorm';

import { SeedObjectMetadata } from 'src/database/typeorm-seeds/metadata/object-metadata';
import { SeedWorkspaceId } from 'src/database/seeds/metadata';

const fieldMetadataTableName = 'fieldMetadata';

export enum SeedPersonFieldMetadata {
  FirstNameMetadataId = '20202020-9b56-4888-bfe3-f6f59aa999e3',
  LastNameMetadataId = '20202020-b784-458a-869d-6c53fa85483d',

  EmailMetadataId = '20202020-8a96-4e4b-86fd-ea126530e0c1',
  LinkedinUrlMetadataId = '20202020-dcf6-445a-b543-37e55de43c25',
  XUrlMetadataId = '20202020-a3a7-4f63-9303-10226f6055be',
  JobTitleMetadataId = '20202020-3b86-413e-ab56-0ebd1a583ff3',
  PhoneMetadataId = '20202020-486f-45f9-bbdf-aac18b1831c0',
  CityMetadataId = '20202020-78f8-4b4c-90ff-86adf77590f5',
  AvatarUrlMetadataId = '20202020-bb05-45cb-aa2a-71b58d49dd23',

  CompanyMetadataId = '20202020-64e1-4080-b6ad-db03c3809885',
  ContactOpportunitiesMetadataId = '20202020-2c2e-418e-ba2d-d28434ff02a6',
  OpportunitiesMetadataId = '20202020-6bc4-4905-a9d3-4f8d616a19e1',
  ActivityTargetsMetadataId = '20202020-f285-4115-a46c-116522986b29',
  FavoritesMetadataId = '20202020-6268-4165-8774-9aaf45db2b25',
  AttachmentsMetadataId = '20202020-5883-4bb3-a308-65271901a1d4',
}

export const seedPersonFieldMetadata = async (
  workspaceDataSource: DataSource,
  schemaName: string,
) => {
  await workspaceDataSource
    .createQueryBuilder()
    .insert()
    .into(`${schemaName}.${fieldMetadataTableName}`, [
      'objectMetadataId',
      'isCustom',
      'workspaceId',
      'isActive',
      'type',
      'name',
      'label',
      'targetColumnMap',
      'description',
      'icon',
      'isNullable',
    ])
    .orIgnore()
    .values([
      // Main Identifier
      {
        id: SeedPersonFieldMetadata.FirstNameMetadataId,
        objectMetadataId: SeedObjectMetadata.PersonMetadataId,
        isCustom: false,
        workspaceId: SeedWorkspaceId,
        isActive: true,
        type: 'TEXT',
        name: 'firstName',
        label: 'First name',
        targetColumnMap: {
          value: 'firstName',
        },
        description: 'Contact’s first name',
        icon: 'IconUser',
        isNullable: false,
      },
      {
        id: SeedPersonFieldMetadata.LastNameMetadataId,
        objectMetadataId: SeedObjectMetadata.PersonMetadataId,
        isCustom: false,
        workspaceId: SeedWorkspaceId,
        isActive: true,
        type: 'TEXT',
        name: 'lastName',
        label: 'Last name',
        targetColumnMap: {
          value: 'lastName',
        },
        description: 'Contact’s last name',
        icon: 'IconUser',
        isNullable: false,
      },

      // Scalar Fields
      {
        id: SeedPersonFieldMetadata.EmailMetadataId,
        objectMetadataId: SeedObjectMetadata.PersonMetadataId,
        isCustom: false,
        workspaceId: SeedWorkspaceId,
        isActive: true,
        type: 'EMAIL',
        name: 'email',
        label: 'Email',
        targetColumnMap: {
          value: 'email',
        },
        description: 'Contact’s Email',
        icon: 'IconMail',
        isNullable: true,
      },
      {
        id: SeedPersonFieldMetadata.LinkedinUrlMetadataId,
        objectMetadataId: SeedObjectMetadata.PersonMetadataId,
        isCustom: false,
        workspaceId: SeedWorkspaceId,
        isActive: true,
        type: 'URL',
        name: 'linkedinUrl',
        label: 'Linkedin',
        targetColumnMap: {
          value: 'linkedinUrl',
        },
        description: 'Contact’s Linkedin account',
        icon: 'IconBrandLinkedin',
        isNullable: true,
      },
      {
        id: SeedPersonFieldMetadata.XUrlMetadataId,
        objectMetadataId: SeedObjectMetadata.PersonMetadataId,
        isCustom: false,
        workspaceId: SeedWorkspaceId,
        isActive: true,
        type: 'URL',
        name: 'xUrl',
        label: 'X',
        targetColumnMap: {
          value: 'xUrl',
        },
        description: 'Contact’s X/Twitter account',
        icon: 'IconUser',
        isNullable: true,
      },
      {
        id: SeedPersonFieldMetadata.JobTitleMetadataId,
        objectMetadataId: SeedObjectMetadata.PersonMetadataId,
        isCustom: false,
        workspaceId: SeedWorkspaceId,
        isActive: true,
        type: 'TEXT',
        name: 'jobTitle',
        label: 'Job Title',
        targetColumnMap: {
          value: 'jobTitle',
        },
        description: 'Contact’s job title',
        icon: 'IconBriefcase',
        isNullable: true,
      },
      {
        id: SeedPersonFieldMetadata.PhoneMetadataId,
        objectMetadataId: SeedObjectMetadata.PersonMetadataId,
        isCustom: false,
        workspaceId: SeedWorkspaceId,
        isActive: true,
        type: 'TEXT',
        name: 'phone',
        label: 'Phone',
        targetColumnMap: {
          value: 'phone',
        },
        description: 'Contact’s phone number',
        icon: 'IconPhone',
        isNullable: true,
      },
      {
        id: SeedPersonFieldMetadata.CityMetadataId,
        objectMetadataId: SeedObjectMetadata.PersonMetadataId,
        isCustom: false,
        workspaceId: SeedWorkspaceId,
        isActive: true,
        type: 'TEXT',
        name: 'city',
        label: 'City',
        targetColumnMap: {
          value: 'city',
        },
        description: 'Contact’s city',
        icon: 'IconMap',
        isNullable: true,
      },
      {
        id: SeedPersonFieldMetadata.AvatarUrlMetadataId,
        objectMetadataId: SeedObjectMetadata.PersonMetadataId,
        isCustom: false,
        workspaceId: SeedWorkspaceId,
        isActive: true,
        type: 'TEXT',
        name: 'avatarUrl',
        label: 'Avatar',
        targetColumnMap: {
          value: 'avatarUrl',
        },
        description: 'Contact’s avatar',
        icon: 'IconFileUpload',
        isNullable: false,
      },

      // Relationships
      {
        id: SeedPersonFieldMetadata.CompanyMetadataId,
        objectMetadataId: SeedObjectMetadata.PersonMetadataId,
        isCustom: false,
        workspaceId: SeedWorkspaceId,
        isActive: true,
        type: 'RELATION',
        name: 'company',
        label: 'Company',
        targetColumnMap: {
          value: 'companyId',
        },
        description: 'Contact’s company',
        icon: 'IconBuildingSkyscraper',
        isNullable: false,
      },
      {
        id: SeedPersonFieldMetadata.ContactOpportunitiesMetadataId,
        objectMetadataId: SeedObjectMetadata.PersonMetadataId,
        isCustom: false,
        workspaceId: SeedWorkspaceId,
        isActive: true,
        type: 'RELATION',
        name: 'pointOfContactForOpporunities',
        label: 'POC for Opportunities',
        targetColumnMap: {},
        description: 'Point of Contact for Opportuniites',
        icon: 'IconArrowTarget',
        isNullable: false,
      },
      {
        id: SeedPersonFieldMetadata.ActivityTargetsMetadataId,
        objectMetadataId: SeedObjectMetadata.PersonMetadataId,
        isCustom: false,
        workspaceId: SeedWorkspaceId,
        isActive: true,
        type: 'RELATION',
        name: 'activityTargets',
        label: 'Activities',
        targetColumnMap: {},
        description: 'Activities tied to the contact',
        icon: 'IconCheckbox',
        isNullable: true,
      },
      {
        id: SeedPersonFieldMetadata.OpportunitiesMetadataId,
        objectMetadataId: SeedObjectMetadata.PersonMetadataId,
        isCustom: false,
        workspaceId: SeedWorkspaceId,
        isActive: true,
        type: 'RELATION',
        name: 'opportunities',
        label: 'Opportunities',
        targetColumnMap: {},
        description: 'Opportunities linked to the contact.',
        icon: 'IconTargetArrow',
        isNullable: true,
      },
      {
        id: SeedPersonFieldMetadata.FavoritesMetadataId,
        objectMetadataId: SeedObjectMetadata.PersonMetadataId,
        isCustom: false,
        workspaceId: SeedWorkspaceId,
        isActive: true,
        type: 'RELATION',
        name: 'favorites',
        label: 'Favorites',
        targetColumnMap: {},
        description: 'Favorites linked to the contact',
        icon: 'IconHeart',
        isNullable: true,
      },
      {
        id: SeedPersonFieldMetadata.AttachmentsMetadataId,
        objectMetadataId: SeedObjectMetadata.PersonMetadataId,
        isCustom: false,
        workspaceId: SeedWorkspaceId,
        isActive: true,
        type: 'RELATION',
        name: 'attachments',
        label: 'Attachments',
        targetColumnMap: {},
        description: 'Attachments linked to the contact.',
        icon: 'IconFileImport',
        isNullable: true,
      },
    ])
    .execute();
};
